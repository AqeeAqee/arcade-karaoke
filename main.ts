namespace userconfig {
    export const ARCADE_SCREEN_WIDTH = 320
    export const ARCADE_SCREEN_HEIGHT = 240
}

game.stats = true
music.setVolume(255)
const bg = game.currentScene().background.image

let selectedSongID = -1
function drawMenu(){
    let myMenu = miniMenu.createMenu(
        miniMenu.createMenuItem("Twinkle Star"),
        miniMenu.createMenuItem("Scarborough Fair"),
        miniMenu.createMenuItem("The Sound Of Silence"),
        miniMenu.createMenuItem("多想还小"),
        miniMenu.createMenuItem("宝贝宝贝"),
        miniMenu.createMenuItem("外婆的澎湖湾"),
        miniMenu.createMenuItem("罗刹海市"),
        miniMenu.createMenuItem("Bad Apple - Kana"),
        miniMenu.createMenuItem("Bad Apple - Roma"),
        miniMenu.createMenuItem("Help"),
    )
    myMenu.setTitle("Karaoke v.1")
    myMenu.setFrame(sprites.dialog.mediumStar.clone())
    myMenu.frame.replace(1, 0)
    myMenu.setDimensions(screen.width, screen.height)
    myMenu.setPosition(1, 1)

    myMenu.setStyleProperty(miniMenu.StyleKind.Default, miniMenu.StyleProperty.Background, 15)
    myMenu.setStyleProperty(miniMenu.StyleKind.Default, miniMenu.StyleProperty.Foreground, 11)
    myMenu.setStyleProperty(miniMenu.StyleKind.Default, miniMenu.StyleProperty.Margin, miniMenu.createBorderBox(1,1,1,1))

    const padding = ((myMenu.width/2-myMenu.frame.width/3)-6*12/2)>>1
    myMenu.setStyleProperty(miniMenu.StyleKind.Title, miniMenu.StyleProperty.Margin, miniMenu.createBorderBox(padding,1,padding,1))
    myMenu.setStyleProperty(miniMenu.StyleKind.Title, miniMenu.StyleProperty.Padding, miniMenu.createBorderBox(1,2,1,2))
    myMenu.setStyleProperty(miniMenu.StyleKind.Title, miniMenu.StyleProperty.Background, 11)
    myMenu.setStyleProperty(miniMenu.StyleKind.Title, miniMenu.StyleProperty.Foreground, 13)
    myMenu.setStyleProperty(miniMenu.StyleKind.Title, miniMenu.StyleProperty.Alignment, miniMenu.Alignment.Center)
    
    myMenu.setStyleProperty(miniMenu.StyleKind.Selected, miniMenu.StyleProperty.Margin, miniMenu.createBorderBox(0,1,22,1))
    myMenu.setStyleProperty(miniMenu.StyleKind.Selected, miniMenu.StyleProperty.Border, miniMenu.createBorderBox(1,1,1,1))
    myMenu.setStyleProperty(miniMenu.StyleKind.Selected, miniMenu.StyleProperty.BorderColor, 13)
    myMenu.setStyleProperty(miniMenu.StyleKind.Selected, miniMenu.StyleProperty.Background, 15)
    myMenu.setStyleProperty(miniMenu.StyleKind.Selected, miniMenu.StyleProperty.Foreground, 5)
    
    myMenu.onButtonPressed(controller.A, function (selection: string, selectedIndex: number) {
        if (selectedIndex == myMenu.items.length-1) {
            game.setDialogFont(image.getFontForText("abc"))
            const frame = sprites.dialog.mediumStar
            frame.replace(1,13)
            game.setDialogFrame(frame)
            game.setDialogTextColor(1) 
            game.showLongText("\
A= pause\n\
B= Restart\n\
↑↓=BPM/Tempo\n\
←→=Sentences\n\
pause+↑↓= Pitch tune\n\
pause+←→= Note width\
", DialogLayout.Full)
        } else {
            selectedSongID = selectedIndex
            myMenu.close()
        }
    })

    pauseUntil(()=>selectedSongID>=0)
}

if (selectedSongID < 0)
    drawMenu()

playSong(selectedSongID)


function playSong(id: number) {
    Karaoke.setLyricWordsSeparator(undefined)
    Karaoke.setLyricSentencesSeparator(undefined)

    //Bad Apple, https://www.bilibili.com/video/BV1xx411c79H/?spm_id_from=333.337.search-card.all.click&vd_source=58d58271edf78dca40f6faf32b808e49
    // https://tieba.baidu.com/p/5159126212
    if (selectedSongID == 7||selectedSongID == 8) {
        const songDrum = music.createSong(hex`0080000408010109010e02026400000403780000040a000301000000640001c80000040100000000640001640000040100000000fa0004af00000401c80000040a00019600000414000501006400140005010000002c0104dc00000401fa0000040a0001c8000004140005d0076400140005d0070000c800029001f40105c201f4010a0005900114001400039001000005c201f4010500058403050032000584030000fa00049001000005c201f4010500058403c80032000584030500640005840300009001049001000005c201f4010500058403c80064000584030500c8000584030000f40105ac0d000404a00f00000a0004ac0d2003010004a00f0000280004ac0d9001010004a00f0000280002d00700040408070f0064000408070000c80003c800c8000e7d00c80019000e64000f0032000e78000000fa00032c01c8000ee100c80019000ec8000f0032000edc000000fa0003f401c8000ea901c80019000e90010f0032000ea4010000fa0001c8000004014b000000c800012c01000401c8000000c8000190010004012c010000c80002c800000404c8000f0064000496000000c80002c2010004045e010f006400042c010000640002c409000404c4096400960004f6090000f40102b80b000404b80b64002c0104f40b0000f401022003000004200300040a000420030000ea01029001000004900100040a000490010000900102d007000410d0076400960010d0070000c800340000000100020007040005000108080009000201070c000d00010810001100020007140015000108180019000201071c001d000108`) as music.sequencer.Song
        const song_O1 = music.createSong(hex`007a000408040109010e02026400000403780000040a000301000000640001c80000040100000000640001640000040100000000fa0004af00000401c80000040a00019600000414000501006400140005010000002c0104dc00000401fa0000040a0001c8000004140005d0076400140005d0070000c800029001f40105c201f4010a0005900114001400039001000005c201f4010500058403050032000584030000fa00049001000005c201f4010500058403c80032000584030500640005840300009001049001000005c201f4010500058403c80064000584030500c8000584030000f40105ac0d000404a00f00000a0004ac0d2003010004a00f0000280004ac0d9001010004a00f0000280002d00700040408070f0064000408070000c80003c800c8000e7d00c80019000e64000f0032000e78000000fa00032c01c8000ee100c80019000ec8000f0032000edc000000fa0003f401c8000ea901c80019000e90010f0032000ea4010000fa0001c8000004014b000000c800012c01000401c8000000c8000190010004012c010000c80002c800000404c8000f0064000496000000c80002c2010004045e010f006400042c010000640002c409000404c4096400960004f6090000f40102b80b000404b80b64002c0104f40b0000f401022003000004200300040a000420030000ea01029001000004900100040a000490010000900102d007000410d0076400960010d0070000c800a800000001000200080800090002000810001100020008180019000200081a001b000200081c001d000200081e001f00020008200021000200082800290002000830003100020008380039000200083c003d00020008400041000200084800490002000850005100020008580059000200085a005b000200085c005d000200085e005f00020008600061000200086800690002000870007100020008780079000200087c007d00020008`) as music.sequencer.Song
        let song_O2 = music.createSong(hex`0080000408040100001c00010a006400f401640000040000000000000000000000000005000004d8000000080001160a000c0001160c000e0001140e00100001161000180001161a001c0001161c001e0001141e00200001162000280001162a002c0001162c002e0001142e003000011630003400011634003600011636003800011938003c00011b3c003e0001193e004000011b4000480001164a004c0001164c004e0001144e00500001165000580001165a005c0001165c005e0001145e00600001166000680001166a006c0001166c006e0001146e007000011670007400011b74007600011976007800011b78007c0001197c007e0001167e0080000119`) as music.sequencer.Song
        const song_A_1 = music.createSong(hex`0078000408040100001c00010a006400f401640000040000000000000000000000000005000004a80000000400011604000800011808000c0001190c001000011b10001800011d18001c0001221c002000012020002800011d28003000011630003400011d34003800011b38003c0001193c004000011840004400011644004800011848004c0001194c005000011b50005800011d58005c00011b5c006000011960006400011864006800011668006c0001186c007000011970007400011874007800011678007c0001157c0080000118`) as music.sequencer.Song
        const song_A_2 = music.createSong(hex`0078000408040100001c00010a006400f401640000040000000000000000000000000005000004900000000400011604000800011808000c0001190c001000011b10001800011d18001c0001221c002000012020002800011d28003000011630003400011d34003800011b38003c0001193c004000011840004400011644004800011848004c0001194c005000011b50005800011d58005c00011b5c006000011960006800011868007000011970007800011b78008000011d`) as music.sequencer.Song
        const song_Bn_123 = music.createSong(hex`0078000408040100001c00010a006400f401640000040000000000000000000000000005000004a80000000400012004000800012208000c00011d0c001000011b10001800011d18001c00011b1c002000011d20002400012024002800012228002c00011d2c003000011b30003800011d38003c00011b3c004000011d40004400011b44004800011948004c0001184c005000011450005800011658005c0001145c006000011660006400011864006800011968006c00011b6c007000011d70007800011678007c00011d7c0080000120`) as music.sequencer.Song
        const song_Bn_4 = music.createSong(hex`0078000408040100001c00010a006400f401640000040000000000000000000000000005000004a80000000400012004000800012208000c00011d0c001000011b10001800011d18001c00011b1c002000011d20002400012024002800012228002c00011d2c003000011b30003800011d38003c0001223c004000012440004400012544004800012448004c0001224c005000012050005800011d58005c00011b5c006000011d60006400011b64006800011968006c0001186c007000011470007800011678007c00011d7c0080000120`) as music.sequencer.Song
        // song_O2= SongEditor.riseFallTone(song_O2, -12)
        // song_O2 = SongEditor.replaceInstrument(song_O2, 8)
        // song_O2 = SongEditor.addHarmony(song_O2, -7)
        const builder_O = new SongEditor
            .Builder(song_O2)
            .riseFallTone(-12)
            .replaceInstrument(8) 
            .addHarmony(-7)
            .repeat(2)
            .insert(song_O1)
            .insert(song_O1)
        const builder = new SongEditor
            .Builder(song_A_1)
            .append(song_A_2)
            .append(song_A_1)
            .append(song_A_2)
            .append(song_Bn_123)
            .append(song_Bn_123)
            .append(song_Bn_123)
            .append(song_Bn_4)
            .append(song_Bn_123)
            .append(song_Bn_123)
            .append(song_Bn_123)
            .append(song_Bn_4)
            .replaceInstrument(6, 0)
            .repeat(2)
            .insert(builder_O.song)
            .fill(true, songDrum)
        
        // https://www.bilibili.com/read/cv7813887/
        // (.+?) for 流（なが）
        const lyric_A="\
        ながれてくときのなかででも\
        けだるさがほらグルグルまわって\
        わたしからはなれるこころも\
        みえないわそうしらない\
        \
        じぶんからうごくこともなく\
        ときのすきまにながされつづけて\
        しらないわまわりのことなど\
        わたしはわたしそれだけ"
        
        const lyric_B13 ="\
        ゆめみてるなにもみてない\
        かたるもむだなじぶんのことば\
        かなしむなんてつかれるだけよ\
        なにもかんじずすごせばいいの\
        とまどうことばあたえられても\
        じぶんのこころただうえのそら\
        もしわたしからうごくのならば\
        すべてかえるのならくろにする"
        
        const lyric_B2 ="\
        こんなじぶんにみらいはあるの\
        こんなせかいにわたしはいるの\
        いませつないのいまかなしいの\
        じぶんのこともわからないまま\
        あゆむことさえつかれるだけよ\
        ひとのことなどしりもしないわ\
        こんなわたしもかわれるのなら\
        もしかわれるのならしろになる--"

        const lyric_B4 = "\
        うごくのならばうごくのならば\
        すべてこわすわすべてこわすわ\
        かなしむならばかなしむならば\
        わたしのこころしろくかわれる\
        あなたのこともわたしのことも\
        すべてのこともまだしらないの\
        おもいまぶたをあけたのならば\
        すべてこわすのならくろになれ--"

        const lyric = (lyric_A + lyric_B13 + lyric_B2 + lyric_A + lyric_B13 + lyric_B4).replaceAll("    ", "#")
        Karaoke.setLyricSentencesSeparator("#")
        if(selectedSongID == 7)
            Karaoke.playSong(builder.song, "Bad Apple", lyric, 3)
        else {
            Karaoke.setLyricWordsSeparator(" ")
            Karaoke.playSong(builder.song, "Bad Apple", Karaoke.Kana2Roma(lyric), 3)
        }
        Karaoke.ppt = 4
    }
    // 外婆的澎湖湾
    if (selectedSongID == 5) {
        let song_A = music.createSong(hex`0050000408080100001c00010a006400f4016400000400000000000000000000000000050000046e0100000400011104000800011408000c0001140c001000011410001400011614001800011918001c0001161c002000011420002400011924002800011928002c0001192c002e0001162e003000011430003800011440004400011d44004800011d48004c00011d4c005000011d50005400011e54005800011d58005c00011b5c006000011960006200011b62006400011b64006600011b66006800011b68006c00011b6c007000011d70007100011d71008000011b80008400011d84008800011d88008a00011d8a008e00011d8e009000011d90009400011e94009800011d98009c00011b9c00a0000119a000a4000116a400a8000119a800ac000119ac00b0000116b000b8000114c000c400011dc400c800011dc800ca00011dca00ce00011dce00d000011dd000d400011ed400d800011dd800dc00011bdc00e0000119e000e2000114e200e4000114e400e6000114e600e8000114e800ea00011bea00ec000119ec00f0000118f00000010119`) as music.sequencer.Song
        let song_B = music.createSong(hex`0050000408080100001c00010a006400f401640000040000000000000000000000000005000004680100000400011104000800011408000c0001140c001000011410001400011614001800011918001a0001161a002000011420002400011924002600011926002800011928002c0001192c002e0001162e003000011430003800011440004400011d44004800011d48004c00011d4c005000011d50005400011e54005800011d58005c00011b5c006000011960006200011b62006600011b66006800011b68006c00011b6c007000011d70007100011d71008000011b80008400011d84008800011d88008a00011d8a008e00011d8e009000011d90009400011e94009800011d98009c00011b9c00a0000119a000a4000116a400a8000119a800aa000119aa00ae000116ae00b0000116b000b8000114c000c400011dc400c800011dc800cc00011dcc00d000011dd000d400011ed400d800011dd800dc00011bdc00de000119de00e0000119e000e4000114e400e8000114e800ea00011bea00ec000119ec00f0000118f00000010119`) as music.sequencer.Song
        let song_C = music.createSong(hex`00780004080b0100001c00010a006400f401640000040000000000000000000000000005000004260100000800011808000c0001180c001000011910001800011b18002000011420002400011924002800011428002c0001192c003000011b30003800011d38004000011b40004400011e44004c00011e4c005000011d50005400011b54005800011958005c0001185c006000011960006c00011b6c007000011d70008000011b80008c00011d8c009000011d90009800011e98009c00011e9c00a000011ba000a600011da600a800011ba800ac000119ac00b0000118b000c0000116c000c4000114c400c8000114d000d4000119d400d8000119e000e800011be800f0000119f000f800011bf800fc000119fc000001011b00010801011d08010c0101200c011001011e10011c01011d1c012001011920012801011828012c0101192c013001011b300150010119`) as music.sequencer.Song
        let song_drum = music.createSong(hex`005a000408010109010e02026400000403780000040a000301000000640001c80000040100000000640001640000040100000000fa0004af00000401c80000040a00019600000414000501006400140005010000002c0104dc00000401fa0000040a0001c8000004140005d0076400140005d0070000c800029001f40105c201f4010a0005900114001400039001000005c201f4010500058403050032000584030000fa00049001000005c201f4010500058403c80032000584030500640005840300009001049001000005c201f4010500058403c80064000584030500c8000584030000f40105ac0d000404a00f00000a0004ac0d2003010004a00f0000280004ac0d9001010004a00f0000280002d00700040408070f0064000408070000c80003c800c8000e7d00c80019000e64000f0032000e78000000fa00032c01c8000ee100c80019000ec8000f0032000edc000000fa0003f401c8000ea901c80019000e90010f0032000ea4010000fa0001c8000004014b000000c800012c01000401c8000000c8000190010004012c010000c80002c800000404c8000f0064000496000000c80002c2010004045e010f006400042c010000640002c409000404c4096400960004f6090000f40102b80b000404b80b64002c0104f40b0000f401022003000004200300040a000420030000ea01029001000004900100040a000490010000900102d007000410d0076400960010d0070000c800350000000100020105040005000105080009000205090c000d0002010510001100010514001500020105180019000205091c001d000105`) as music.sequencer.Song
        // let song_drum2 = music.createSong(hex`005a000408010109010e02026400000403780000040a000301000000640001c80000040100000000640001640000040100000000fa0004af00000401c80000040a00019600000414000501006400140005010000002c0104dc00000401fa0000040a0001c8000004140005d0076400140005d0070000c800029001f40105c201f4010a0005900114001400039001000005c201f4010500058403050032000584030000fa00049001000005c201f4010500058403c80032000584030500640005840300009001049001000005c201f4010500058403c80064000584030500c8000584030000f40105ac0d000404a00f00000a0004ac0d2003010004a00f0000280004ac0d9001010004a00f0000280002d00700040408070f0064000408070000c80003c800c8000e7d00c80019000e64000f0032000e78000000fa00032c01c8000ee100c80019000ec8000f0032000edc000000fa0003f401c8000ea901c80019000e90010f0032000ea4010000fa0001c8000004014b000000c800012c01000401c8000000c8000190010004012c010000c80002c800000404c8000f0064000496000000c80002c2010004045e010f006400042c010000640002c409000404c4096400960004f6090000f40102b80b000404b80b64002c0104f40b0000f401022003000004200300040a000420030000ea01029001000004900100040a000490010000900102d007000410d0076400960010d0070000c800340000000100020005040005000105080009000205090c000d00010510001100020205140015000105180019000205091c001d000105`) as music.sequencer.Song
        
        const builder=new SongEditor.Builder(song_A)
            .append(song_B)
            .append(song_C)
            // .riseFallTone(-3)
            .addInstrumentHarmony([6])
            .fill(true, song_drum)
        /*
        let song = SongEditor.append(song_A, song_B)
        song = SongEditor.riseFallTone(song, -12)
        // song = SongEditor.addTracks(song, SongEditor.riseFallTone(song, -5))
        info.setScore(song.tracks.length)
        song_drum = SongEditor.repeat(song_drum, song.measures)
        song = SongEditor.merge(song, song_drum)
        */

        let lyric_A = "\
        晚风轻拂澎湖湾-;\
        白浪逐沙-滩;\
        没有椰林醉斜阳-;\
        只是一片海蓝蓝-;\
        坐在门前的矮墙上-;\
        一遍遍怀想;\
        也是黄昏的沙滩上-;\
        有着脚印两-对半;"
        let lyric_B = "\
        那是外婆柱着杖-;\
        将我手轻轻-挽;\
        踩着薄暮走向余晖;\
        暖暖的澎湖湾-;\
        一个脚印是笑语一串;\
        消磨许多时光;\
        直到夜色吞没我俩;\
        在回家的-路上;"
        let lyric_C = "\
        澎湖-湾- 澎-湖-湾-;\
        外婆的澎-湖-湾--;\
        有我许多的童年幻-想;\
        阳光 沙滩 海浪 仙人-掌;\
        还有一位老船-长;"
        let lyric = lyric_A + lyric_B + lyric_C
        Karaoke.setLyricSentencesSeparator(";")
        Karaoke.playSong(builder.song, "外婆的澎湖湾", lyric)

    }
    //Scarborough Fair 1=C
    // https://www.bilibili.com/video/BV1V7411B7XJ/?vd_source=58d58271edf78dca40f6faf32b808e49
    if (selectedSongID == 1) {
        const songDrum = music.createSong(hex`004d000408010109010e02026400000403780000040a000301000000640001c80000040100000000640001640000040100000000fa0004af00000401c80000040a00019600000414000501006400140005010000002c0104dc00000401fa0000040a0001c8000004140005d0076400140005d0070000c800029001f40105c201f4010a0005900114001400039001000005c201f4010500058403050032000584030000fa00049001000005c201f4010500058403c80032000584030500640005840300009001049001000005c201f4010500058403c80064000584030500c8000584030000f40105ac0d000404a00f00000a0004ac0d2003010004a00f0000280004ac0d9001010004a00f0000280002d00700040408070f0064000408070000c80003c800c8000e7d00c80019000e64000f0032000e78000000fa00032c01c8000ee100c80019000ec8000f0032000edc000000fa0003f401c8000ea901c80019000e90010f0032000ea4010000fa0001c8000004014b000000c800012c01000401c8000000c8000190010004012c010000c80002c800000404c8000f0064000496000000c80002c2010004045e010f006400042c010000640002c409000404c4096400960004f6090000f40102b80b000404b80b64002c0104f40b0000f401022003000004200300040a000420030000ea01029001000004900100040a000490010000900102d007000410d0076400960010d0070000c8001200000001000108080009000107100011000107`) as music.sequencer.Song

        const song_A = music.createSong(hex`006e000408170100001c00010a006400f401640000040000000000000000000000000005000004d80000001000011b10001800011b20003000012230003800012240004c00011d4c005000011e50005800011d60009000011ba800b0000122b000b8000125c000d0000127d000d8000125e000e8000122e800f0000124f000f8000120000130010122700178010127800190010127900198010127a001b0010125b001b8010122c001c8010122c801d0010120d001d801011ee001e401011de401e8010119e801f801011920023002011b30023802012240025002012050025802011e60026802011d68027002011b70027802011980028402011d8402b002011b`) as music.sequencer.Song
        const song_B = music.createSong(hex`006e000408170100001c00010a006400f401640000040000000000000000000000000005000004e40000000800011b08001000011b10001800011b20002800012228003000012230003800012240004c00011d4c005000011e50005800011d60009000011ba800b0000122b000b8000125c000d0000127d000d8000125e000e8000122e800f0000124f000f8000120000130010122700178010127800190010127900198010127a001b0010125b001b8010122c001c8010122c801d0010120d001d801011ee001e401011de401e8010119e801f801011920023002011b30023802012240025002012050025802011e60026802011d68027002011b70027802011980028402011d8402b002011b`) as music.sequencer.Song
        const builder = new SongEditor
            .Builder(song_A)
            .append(song_B)
            .append(song_B)
            .append(song_B)
            .riseFallTone(-12)
            // .replaceInstrument(5)
            // .addHarmony(-5)
            .addInstrumentHarmony([5, 6])
            .fill(true, songDrum)
            .reduceBeats(6)
        // .printTree().printBuf()

        builder.song.beatsPerMinute = 130

        let lyricA = "\
        Are- you going to Scar-bo-rough Fair\
        Par-sley sage rose-ma-ry and thyme\
        Re-mem-ber me to one who lives there---\
        He once was a true love of mine--"
        let lyricB1 = "\
        Tell him to make me a cam--bric shirt\
        Par-sley sage rose-ma-ry and thyme\
        Wi-thout no seams nor nee--dle work---\
        Then he'll be a true love of mine--"
        let lyricB2 = "\
        Tell him to find me an acre-- of land\
        Par-sley sage rose-ma-ry and thyme\
        Be-tween the salt water and the sea strands---\
        Then he'll be a true love of mine--"
        let lyricB3 = "\
        Tell him to reap it with'a sickle-- of leather\
        Par-sley sage rose-ma-ry and thyme\
        And gather it all in a bunch of heather---\
        Then he'll be a true love of mine--"
        const lyric = lyricA + lyricB1 + lyricB2 + lyricB3

        Karaoke.setLyricWordsSeparator(" ") //required for lyric in english, or languages that compose words with letters
        Karaoke.playSong(builder.song, "Scarborough Fair", lyric)
        // or Karaoke.playSong(builder.song)
        Karaoke.ppt = 3

    }
    //Twinkle Star
    else if (selectedSongID == 0) {
        const songDrum = music.createSong(hex`004d000408010109010e02026400000403780000040a000301000000640001c80000040100000000640001640000040100000000fa0004af00000401c80000040a00019600000414000501006400140005010000002c0104dc00000401fa0000040a0001c8000004140005d0076400140005d0070000c800029001f40105c201f4010a0005900114001400039001000005c201f4010500058403050032000584030000fa00049001000005c201f4010500058403c80032000584030500640005840300009001049001000005c201f4010500058403c80064000584030500c8000584030000f40105ac0d000404a00f00000a0004ac0d2003010004a00f0000280004ac0d9001010004a00f0000280002d00700040408070f0064000408070000c80003c800c8000e7d00c80019000e64000f0032000e78000000fa00032c01c8000ee100c80019000ec8000f0032000edc000000fa0003f401c8000ea901c80019000e90010f0032000ea4010000fa0001c8000004014b000000c800012c01000401c8000000c8000190010004012c010000c80002c800000404c8000f0064000496000000c80002c2010004045e010f006400042c010000640002c409000404c4096400960004f6090000f40102b80b000404b80b64002c0104f40b0000f401022003000004200300040a000420030000ea01029001000004900100040a000490010000900102d007000410d0076400960010d0070000c80030000000010001010400050001070800090001090c000d0001071000110001011400150001071800190001091c001d000107`) as music.sequencer.Song
        const song_A = music.createSong(hex`0042000408020100001c00010a006400f401640000040000000000000000000000000005000004540000000400011904000800011908000c0001200c001000012010001400012214001800012218002000012020002400011e24002800011e28002c00011d2c003000011d30003400011b34003800011b380040000119`) as music.sequencer.Song
        const song_B = music.createSong(hex`0042000408020100001c00010a006400f401640000040000000000000000000000000005000004540000000400012004000800012008000c00011e0c001000011e10001400011d14001800011d18001c00011b20002400012024002800012028002c00011e2c003000011e30003400011d34003800011d38003c00011b`) as music.sequencer.Song
        const builder = new SongEditor
            .Builder(song_A)
            .append(song_B)
            .append(song_A)
            .fill(true, songDrum)

        let lyric_A = "\
        twin-kle twin-kle lit-tle star \
        How I won-der whats you are "
        let lyric_B = "\
        Up a-bove the world so high\
        Like a dia-mond in the sky"
        const lyric = lyric_A + lyric_B + lyric_A

        Karaoke.setLyricWordsSeparator(" ") //required for lyric in english, or languages that compose words with letters
        Karaoke.playSong(builder.song, "Twinkle Star", lyric)

    }
    //The Sound Of Silence
    else if (selectedSongID == 2) {
        const songDrum = music.createSong(hex`004d000408010109010e02026400000403780000040a000301000000640001c80000040100000000640001640000040100000000fa0004af00000401c80000040a00019600000414000501006400140005010000002c0104dc00000401fa0000040a0001c8000004140005d0076400140005d0070000c800029001f40105c201f4010a0005900114001400039001000005c201f4010500058403050032000584030000fa00049001000005c201f4010500058403c80032000584030500640005840300009001049001000005c201f4010500058403c80064000584030500c8000584030000f40105ac0d000404a00f00000a0004ac0d2003010004a00f0000280004ac0d9001010004a00f0000280002d00700040408070f0064000408070000c80003c800c8000e7d00c80019000e64000f0032000e78000000fa00032c01c8000ee100c80019000ec8000f0032000edc000000fa0003f401c8000ea901c80019000e90010f0032000ea4010000fa0001c8000004014b000000c800012c01000401c8000000c8000190010004012c010000c80002c800000404c8000f0064000496000000c80002c2010004045e010f006400042c010000640002c409000404c4096400960004f6090000f40102b80b000404b80b64002c0104f40b0000f401022003000004200300040a000420030000ea01029001000004900100040a000490010000900102d007000410d0076400960010d0070000c80030000000010001000400050001070800090001090c000d0001071000110001001400150001071800190001091c001d000107`) as music.sequencer.Song
        const song_A = music.createSong(hex`005a0004080f0100001c00010a006400f4016400000400000000000000000000000000050000044a0108000c0001160c001000011610001400011914001800011918001c00011d1c002000011d20003800011b44004600011446004800011448004c0001144c005000011450005400011854005800011858005c00011b5c006000011b60007800011984008800011988008c0001198c009000011990009400011d94009800011d9800a0000120a000a8000122a800ac000122ac00b8000120c800cc000119cc00d0000119d000d400011dd400d800011dd800dc000120dc00e0000120e000e8000122e800ec000122ec00f800012008010c0101190c011001011910011401012214012001012228012c0101222c013001012430013401012534014001012540014401012444014c0101224c015401012068016c0101226c017001012070017801011d94019801011998019c0101199c01a0010119a001b0010120bc01c0010118c001c4010119c401d0010116`) as music.sequencer.Song
        const song_A1 = music.createSong(hex`005a0004080f0100001c00010a006400f4016400000400000000000000000000000000050000044a0108000c0001160c001000011610001400011914001800011918001c0001161c002000011620003800011444004600011446004800011448004c0001144c005000011450005400011454005800011458005c0001145c006000011460007800011684008800011988008c0001198c00900001199000940001199400980001199800a0000119a000a8000119a800ac000119ac00b8000119c800cc000119cc00d0000119d000d4000119d400d8000119d800dc000119dc00e0000119e000e8000119e800ec000119ec00f800011908010c0101190c011001011910011401011914012001011928012c0101192c013001011930013401011e34014001011e40014401011e44014c01011e4c015401011d68016c01011d6c017001011b70017801011994019801011998019c0101199c01a0010119a001b0010118bc01c0010118c001c4010119c401d0010116`) as music.sequencer.Song
        // const song_A1 = music.createSong(hex`005a0004080f0100001c00010a006400f4016400000400000000000000000000000000050000044a0108000c0001160c001000011610001400011914001800011918001c0001161c002000011620003800011444004600011446004800011448004c0001144c005000011450005400011454005800011458006000011460007800011684008800011988008c0001198c009000011990009400011994009800011998009c0001199c00a0000119a000a8000119a800ac000119ac00b8000119c800cc000119cc00d0000119d000d4000119d400d8000119d800dc000119dc00e0000119e000e8000119e800ec000119ec00f800011908010c0101190c011001011910011401011914012001011928012c0101192c013001011930013401011e34014001011e40014401011e44014c01011e4c015401011d68016c01011d6c017001011b70017801011994019801011998019c0101199c01a0010119a001b0010118bc01c0010118c001c4010119c401d0010116`) as music.sequencer.Song
        const song_B = music.createSong(hex`005a0004080f0100001c00010a006400f401640000040000000000000000000000000005000004680104000800011608000c0001160c001000011610001400011914001800011918001a00011d1a001c00011b1c002000011920003000011b48004c0001164c005000011650005400011954005800011958005c00011b5c006000011b60007000011988008c0001198c009000011990009400011d94009800011d98009c0001209c00a0000120a000a8000122a800ac000122ac00b4000120c400c8000119c800cc000119cc00d0000119d000d400011dd400d800011dd800dc000120dc00e0000120e000e8000122e800ec000122ec00f400012008010c0101190c011001011910011801012218011c0101221c012001012220012401012228012c0101222c013001012430013801012538013c0101253c014001012540014401012444014c0101224c015401012064016801012068016c0101226c017001012070017801011d94019801011998019c0101199c01a0010119a001b0010120bc01c0010118c001c4010119c401d0010116`) as music.sequencer.Song
        const lyric_A = " \
        He-llo dark-ness my old friend \
        I 've come to talk with you a-gain \
        Be-cause a vi-sion soft-ly cree-ping \
        Left its see-ds while I was slee-ping \
        And the vi-sion that was plan-ted \
        In my brain still re-mains \
        Wi-thin the sound of si-lence "
        const lyric_B = " \
        In rest-less dreams I wal-ked a-lone \
        Nar-row streets of cob-ble stone \
        Be-neath the ha-lo of a street lamp \
        I turned my col-lar to the cold and damp \
        When my eyes were stab-bed \
        By the flash of a ne-on light \
        That split the night \
        And touched the sound of si-lence "

        //lyric_C undone
        const lyric_C = " \
        And in the naked light I saw \
        Ten thousand people maybe more \
        People talking without speaking \
        People hearing without listening \
        People writing songs that voices never share \
        And no one dare \
        Disturb the sound of silence \
        Fool said I, You do not know \
        Silence like a cancer grows \
        Hear my words that I might teach you \
        Take my arms that I might reach you \
        But my words like silent raindrops fell \
        And echoed in the walls of silence \
        And the people bowed and prayed \
        To the neon god they made \
        And the sign flashed out its warning \
        In the words that it was forming \
        And the signs said The words of the prophets \
        are written on the subway walls \
        And tenement halls \
        Whispering in the sounds of silence"

        let song = SongEditor.addTracks(song_A, song_A1.tracks)
        song = SongEditor.append(song, song_B)
        let songDrums = SongEditor.repeat(songDrum, song.measures)
        song = SongEditor.merge(song, songDrums)

        const builder = new SongEditor
            .Builder(song_A)
            .addTracks(song_A1.tracks)
            .fill(true, songDrum)

        const lyric = lyric_A + lyric_B
        Karaoke.setLyricWordsSeparator(" ")
        Karaoke.playSong(builder.song, "The Sound Of Silence", lyric)
    }
    // 罗刹海市 
    // https://www.yqku.com/24701.html
    // https://www.midishow.com/midi/175281.html
    // https://musescore.com/user/11147046/scores/11695180
    else if (selectedSongID == 6) {
        const song_0 = music.createSong(hex`0096000408040100001c00010a006400f401640000040000000000000000000000000005000004900008000a0001200a001000012210001200012012001600012216001800012018002000012228002a0001202a003000012230003200012032003600012236003800012038004000012248004a0001204a005000012250005200012052005600012256005800012058006000012268006a0001206a007000012270007200012072007600012276007800012078007c000122`) as music.sequencer.Song
        const song_A1 = music.createSong(hex`00960004080a0100001c00010a006400f4016400000400000000000000000000000000050000048c0104000800011d08000c00011d0c001000011d10001400011414001600011416001800011618001a0001161a001c00011920002200011922002400011628002c0001222c003000012030003400011d34003800011d38003a0001203a003c00011d40004400011d44004800011b4c005000011d50005400011954005800011d58005c00011d60006400011d64006800011668006c00011970007400011974007800011978007c00011480008400011684008500011685008600011b86008800011688008c0001148c009000011194009800011198009c000119a000a4000119a400aa000111aa00ac000114ac00b0000119b000b8000119b800bc00011bc000c600011bc600c8000118c800cc000116cc00ce000118ce00d0000116d000d4000114d400d8000111e000e800011de800ec00011dec00ee00011dee00f0000120f000f200011df200f400011bf400f8000116f8000001011904010c0101110c010e01011b0e011001011810011401011614011501011615011601011b16011801011618011c010114200124010111`) as music.sequencer.Song
        const song_AB1 = music.createSong(hex`0096000408010100001c00010a006400f4016400000400000000000000000000000000050000042a0004000600011406000a0001160a000c0001140c001000011610001400011614001800011918001c000122`) as music.sequencer.Song
        const song_B1 = music.createSong(hex`00960004080c0100001c00010a006400f401640000040000000000000000000000000005000004fb0104000800011608000c0001110c001000011410001400011614001600011616001800011418001c00011620002100011921002200011b22002800011928002c00010d2c003000010d30003400011434003a0001113a003c0001144000440001114c00540002161d5400580002161d58005a00011d5a005c00012060006200011d62006400011b64006800011668007000011970007800011178007a00011b7a007c00011880008400011684008500011685008600011b86008800011688008c0001148c009000011194009800011498009c000111a000a4000114a400a8000116a800aa000116aa00ac000119ac00b0000116b000b4000114b400b800010fb800bc000114c400c60002111dc600c80002111dc800cc0002111dcc00d000021116d000d4000114d400d600011bd600d8000118d800dc000116e800ec0002161dec00f00002161df000f40002161df400f80002161df800fc00012000010401011604010801011908010c01021d220c011001012010011401011b14011a01011d1a011c01012020012801011d2c013001021d2230013401021d2234013801021d2238013c01021d2240014201012742014401012444014801012248014a0101204a014c01011d4c014e01011b4e015001011b50015201011d52015401012054015601011d56015801011b58015a0101195a015c010118600164010116`) as music.sequencer.Song
        const song_C = music.createSong(hex`00960004080a0100001c00010a006400f401640000040000000000000000000000000005000004610104000800011608000c0001110c001000011410001400011614001800011618001a00011b1a001c00011820002200011622002400011428002c0001112c003000011130003400011434003800010d38003c00010a44004800011148004c0001144c005000011150005400010a54005800010a58005c00010d60006400010a68006c000211166c00700002111670007400011474007a0001117a007c00011480008400011184008c0001168c009000011690009400011b94009800011898009c000116a000a4000111a400ac000116ac00b000010fb000b4000114b400b8000111c000c80002141bc800cc0002141bcc00d00002141bd000d4000118d400d8000116d800dc000114e400e8000111e800ec00011bec00f0000118f000f4000116f400f6000116f600f8000118f800fc00011400010401011108010a0101110a010c0101140c011001010f10011401010f14011801010c18012001010a24012801010a`) as music.sequencer.Song
        const song_A2 = music.createSong(hex`0096000408090100001c00010a006400f4016400000400000000000000000000000000050000046e0104000800011d08000c00011d0c001000011d10001200011d12001400012014001600011d16001800011b18001c00011620002200011122002800011428002c0001222c003000012030003400011b34003a00011d3a003c00012040004400011d4c005000011d50005400011954005800011d58005c00011d60006200011462006400011664006800011168006c0001146c007000011970007600011976007800011978007c00011480008600011686008700011987008800011688008c00011494009800011198009c000119a000a4000119a400aa000111aa00ac000114ac00b0000119b000b8000119b800bc00011bc000c400011bc400c8000118c800cc000116cc00ce000118ce00d0000116d000d4000114d400d8000111e000e800011de800ec00011dec00ee00011dee00f0000120f000f200011df200f400011bf4000001011d04010801011108010c0101190c011001011810011601011616011701011b17011801011618011c010114`) as music.sequencer.Song
        const song_B2 = music.createSong(hex`0096000408100100001c00010a006400f401640000040000000000000000000000000005000004780204000800011608000c0001110c001000011410001600011616001800011418001c00011620002400011928003000010d30003400011434003a0001113a003c0001144000480001114c00540002161d5400580002161d58005a00011d5a005c00012060006200011d62006400011b64006800011d68006c00011d70007400011174007800011978007c00011880008600011686008700011987008800011688008c0001148c009000011690009400011194009800011498009c000116a000a200011ba200a4000118a400a8000116a800ac000114b000b8000111b800bc000114c000c6000111c600c8000114c800d0000111d400dc00011de000e400011de400e600011de600e8000120e800ea00011dea00ec00011bec00f000011df000f800011df800fc00011100010401011904010801011808010e0101160e010f0101190f011001011610011401011414011801011418011c01011120012401011924012801011928012a0101162a012c0101142c013001011630013401011434013801011140014401011d44014801011d48014c01011d4c015001011650015401011454015601011b56015801011858015c01011664016801011d68016c01011d6c017001011d70017401011d74017801012078017c01011680018401011984018801011688018c0101168c019001012290019401012094019a01011d9a019c010120a001a401011da401ac01011dac01b0010122b001b4010122b401b8010122b801bc010122c001c2010127c201c4010124c401c8010122c801ca010120ca01cc01011dcc01ce01011bce01d001011bd001d201011dd201d4010120d401d601011dd601d801011bd801da010119da01dc010118e001e4010116`) as music.sequencer.Song
        const song_B3 = music.createSong(hex`0096000408070100001c00010a006400f401640000040000000000000000000000000005000004260114001800011418001c00011120002400011924002600011626002800011928002a0001162a002c0001142c003000011630003400011434003800011140004400011d44004800011d48004c00011d4c005000011650005400011454005600011b56005800011858005c00011668006c00011d6c007000011d70007400011d74007800011d78007c00012080008400011684008800011988008c0001168c009000011690009400012294009800012098009e00011da200a4000120a400a800011da800ac000122ac00b0000122b000b4000122b400b8000122b800bc000127c000c4000122c400c6000120c600c800011dc800ca00011bca00cc00011bcc00ce00011dce00d0000120d000d200011dd200d400011bd400d6000119d600d8000118d800dc000116`) as music.sequencer.Song
        const song_D0 = music.createSong(hex`004b000408040100001c00010a006400f401640000040000000000000000000000000005000004260100000400011904000600011606000700011907000800011608000a0001140a000c0001160c000e00011b0e001000011810001200011612001300011813001400011614001600011416001800011618001c00011620002400011924002600011626002700011927002800011628002a0001142a002c0001162c002e00011b2e003000011830003600011636003700011837003800011638003a0001143a003c00011640004600011146004800011448004a00011b4a004c0001184c005000011650005200011452005400011654005600011156005800011458005a00011b5a005c00011860006200011662006300011863006400011664006600011466006800011668006a0001116a006c0001146c007000011670007200011972007400011874007c000116`) as music.sequencer.Song
        const song_test = music.createSong(hex`0078000408020100001c00010a006400f4016400000400000000000000000000000000050000040c0000000400010504000800012c`) as music.sequencer.Song
        const song_drum = music.createSong(hex`005a000408010109010e02026400000403780000040a000301000000640001c80000040100000000640001640000040100000000fa0004af00000401c80000040a00019600000414000501006400140005010000002c0104dc00000401fa0000040a0001c8000004140005d0076400140005d0070000c800029001f40105c201f4010a0005900114001400039001000005c201f4010500058403050032000584030000fa00049001000005c201f4010500058403c80032000584030500640005840300009001049001000005c201f4010500058403c80064000584030500c8000584030000f40105ac0d000404a00f00000a0004ac0d2003010004a00f0000280004ac0d9001010004a00f0000280002d00700040408070f0064000408070000c80003c800c8000e7d00c80019000e64000f0032000e78000000fa00032c01c8000ee100c80019000ec8000f0032000edc000000fa0003f401c8000ea901c80019000e90010f0032000ea4010000fa0001c8000004014b000000c800012c01000401c8000000c8000190010004012c010000c80002c800000404c8000f0064000496000000c80002c2010004045e010f006400042c010000640002c409000404c4096400960004f6090000f40102b80b000404b80b64002c0104f40b0000f401022003000004200300040a000420030000ea01029001000004900100040a000490010000900102d007000410d0076400960010d0070000c8002d000000010002070a040005000107080009000207090c000d00010710001100020709140015000107180019000107`) as music.sequencer.Song
        const song_drum2 = music.createSong(hex`005a000408010109010e02026400000403780000040a000301000000640001c80000040100000000640001640000040100000000fa0004af00000401c80000040a00019600000414000501006400140005010000002c0104dc00000401fa0000040a0001c8000004140005d0076400140005d0070000c800029001f40105c201f4010a0005900114001400039001000005c201f4010500058403050032000584030000fa00049001000005c201f4010500058403c80032000584030500640005840300009001049001000005c201f4010500058403c80064000584030500c8000584030000f40105ac0d000404a00f00000a0004ac0d2003010004a00f0000280004ac0d9001010004a00f0000280002d00700040408070f0064000408070000c80003c800c8000e7d00c80019000e64000f0032000e78000000fa00032c01c8000ee100c80019000ec8000f0032000edc000000fa0003f401c8000ea901c80019000e90010f0032000ea4010000fa0001c8000004014b000000c800012c01000401c8000000c8000190010004012c010000c80002c800000404c8000f0064000496000000c80002c2010004045e010f006400042c010000640002c409000404c4096400960004f6090000f40102b80b000404b80b64002c0104f40b0000f401022003000004200300040a000420030000ea01029001000004900100040a000490010000900102d007000410d0076400960010d0070000c8002d00000001000200050400050001050800090002050a0c000d0001051000110002050a140015000105180019000105`) as music.sequencer.Song

        const builder = new SongEditor.Builder(song_A1)
            .append(song_AB1, true)
            .append(song_B1)
            .append(song_C, true)
            .append(song_A2)
            .append(song_B2)
            .append(song_C, true)
            .append(song_B3,)
            .append(song_D0)
            .riseFallTone(12)
            .addHarmony(-5)
            .fill(false, song_drum)
            .reduceBeats(7)
            // .printTree()

        // builder.song.beatsPerMinute=100

        let lyric_A1 = "\
        罗刹国向东-两-万-    六千-里--呀-\
        过七冲越焦海-    三寸的黄泥--地-\
        只为那有-一条    一丘-河--啊-\
        河水流---过-苟苟-营呐----"
        let lyric_AB1 = "......."
        let lyric_B1 = "\
        苟苟营当家的叉杆-儿唤作马户--\
        十里花---场啊有浑-名啊----\
        她两耳傍肩-三孔鼻-\
        未曾开言先转-腚\
        每一日蹲窝里-\
        把蛋来卧--\
        老粉嘴多半-辈 啊-\
        以为自己是-只-鸡"
        let lyric_C1 = "\
        那马户不知道-他-是一头驴-\
        那又鸟不知道他是一只鸡--\
        勾栏从来- 扮高雅--\
        自古公-公-好威-名哪---\
        哎-哎哎--呀"
        let lyric_A2 = "\
        打西边来了一个小伙儿 他叫马骥--\
        美丰姿 少倜-傥- 华夏的子弟---\
        只为他人海泛舟搏风打浪----\
        龙游险---滩 流落恶地---"
        let lyric_B2 = "\
        他见这罗刹国里常颠倒--\
        马户爱---听那又鸟的曲---\
        三更的草鸡-打鸣当司晨--\
        半扇门---楣上裱真-情---\
        它红描翅那个黑画皮\
        绿绣鸡冠金镶-蹄\
        可是那从来煤蛋儿生来就黑-- 呀\
        不管你咋样-洗呀-那也是个脏-东-西"
        let lyric_C2 = "\
        那马户不知道-他-是一头驴-\
        那又鸟不知道他是一只鸡--\
        岂有画堂- 登猪狗--\
        哪来鞋-拔-作如-意啊---\
        哎-哎哎--呀"
        let lyric_B3 = "\
        它红描翅-那个黑画皮\
        绿绣鸡冠金镶-蹄\
        可是那从来煤蛋儿生来就黑- 呀\
        不管你咋样洗呀-那也是个脏-东-西"
        let lyric = lyric_A1 + lyric_AB1 + lyric_B1 + lyric_C1 + lyric_A2 + lyric_B2 + lyric_C2 + lyric_B3//
        Karaoke.setLyricSentencesSeparator("#")
        Karaoke.playSong(builder.song, "罗刹海市", lyric.replaceAll("  ", "#"))
    }
    //多想还小
    else if (selectedSongID == 3) {
        const songDrum_1 = music.createSong(hex`0042000408010109010e02026400000403780000040a000301000000640001c80000040100000000640001640000040100000000fa0004af00000401c80000040a00019600000414000501006400140005010000002c0104dc00000401fa0000040a0001c8000004140005d0076400140005d0070000c800029001f40105c201f4010a0005900114001400039001000005c201f4010500058403050032000584030000fa00049001000005c201f4010500058403c80032000584030500640005840300009001049001000005c201f4010500058403c80064000584030500c8000584030000f40105ac0d000404a00f00000a0004ac0d2003010004a00f0000280004ac0d9001010004a00f0000280002d00700040408070f0064000408070000c80003c800c8000e7d00c80019000e64000f0032000e78000000fa00032c01c8000ee100c80019000ec8000f0032000edc000000fa0003f401c8000ea901c80019000e90010f0032000ea4010000fa0001c8000004014b000000c800012c01000401c8000000c8000190010004012c010000c80002c800000404c8000f0064000496000000c80002c2010004045e010f006400042c010000640002c409000404c4096400960004f6090000f40102b80b000404b80b64002c0104f40b0000f401022003000004200300040a000420030000ea01029001000004900100040a000490010000900102d007000410d0076400960010d0070000c8000c00080009000109180019000109`) as music.sequencer.Song
        const songDrum_11 = music.createSong(hex`0042000408010109010e02026400000403780000040a000301000000640001c80000040100000000640001640000040100000000fa0004af00000401c80000040a00019600000414000501006400140005010000002c0104dc00000401fa0000040a0001c8000004140005d0076400140005d0070000c800029001f40105c201f4010a0005900114001400039001000005c201f4010500058403050032000584030000fa00049001000005c201f4010500058403c80032000584030500640005840300009001049001000005c201f4010500058403c80064000584030500c8000584030000f40105ac0d000404a00f00000a0004ac0d2003010004a00f0000280004ac0d9001010004a00f0000280002d00700040408070f0064000408070000c80003c800c8000e7d00c80019000e64000f0032000e78000000fa00032c01c8000ee100c80019000ec8000f0032000edc000000fa0003f401c8000ea901c80019000e90010f0032000ea4010000fa0001c8000004014b000000c800012c01000401c8000000c8000190010004012c010000c80002c800000404c8000f0064000496000000c80002c2010004045e010f006400042c010000640002c409000404c4096400960004f6090000f40102b80b000404b80b64002c0104f40b0000f401022003000004200300040a000420030000ea01029001000004900100040a000490010000900102d007000410d0076400960010d0070000c8000c00080009000109180019000108`) as music.sequencer.Song
        const songDrum_2 = music.createSong(hex`0042000408010109010e02026400000403780000040a000301000000640001c80000040100000000640001640000040100000000fa0004af00000401c80000040a00019600000414000501006400140005010000002c0104dc00000401fa0000040a0001c8000004140005d0076400140005d0070000c800029001f40105c201f4010a0005900114001400039001000005c201f4010500058403050032000584030000fa00049001000005c201f4010500058403c80032000584030500640005840300009001049001000005c201f4010500058403c80064000584030500c8000584030000f40105ac0d000404a00f00000a0004ac0d2003010004a00f0000280004ac0d9001010004a00f0000280002d00700040408070f0064000408070000c80003c800c8000e7d00c80019000e64000f0032000e78000000fa00032c01c8000ee100c80019000ec8000f0032000edc000000fa0003f401c8000ea901c80019000e90010f0032000ea4010000fa0001c8000004014b000000c800012c01000401c8000000c8000190010004012c010000c80002c800000404c8000f0064000496000000c80002c2010004045e010f006400042c010000640002c409000404c4096400960004f6090000f40102b80b000404b80b64002c0104f40b0000f401022003000004200300040a000420030000ea01029001000004900100040a000490010000900102d007000410d0076400960010d0070000c800350000000100020006040005000106080009000206090c000d0002000610001100010614001500020006180019000206091c001d000106`) as music.sequencer.Song
        let song_A = music.createSong(hex`006a000408090100001c00010a006400f401640000040000000000000000000000000005000004080118001e0001191e00200001162000240001162400280001162c003000011630003400011634003800011938003c0001163c004000011640004800011d54005800011d58005c00011b5c006000011960006800011b68006c00011b6c007000011d70007400011b74007800011978007c0001167c008000011480008400011194009800011998009e0001169e00a0000114a000a4000116a400a8000116ac00b0000116b000b4000116b400b8000119b800bc000116bc00c0000116c000c800011dd400d800011dd800dc00011bdc00e0000119e000e800011be800ec00011bec00f000011df000f400011bf400f8000119f800fc000116fc0000010119000104010116040108010116`) as music.sequencer.Song
        let song_B = music.createSong(hex`006A000408090100001c00010a006400f4016400000400000000000000000000000000050000041a0114001800011d18001c00011d1c002000011b20002400011d24002800012228002c00011d2c003000011b30003400011d34003800012238003c00011d3c004000011b40004800011d58005c0001165c006000011d60006800011b68006e00011b6e007000011970007400011b74007800011d78007c0001207c008000011b80008400011b84008800011d94009800011d98009c00011d9c00a000011ba000a800011da800ac000120ac00b0000122b000b4000120b400b800011db800bc00011dbc00c0000120c000c400011bc400c800011dd400d800011dd800dc00011bdc00e0000119e000e400011be400e800011bec00f0000119f000f400011bf400f800011bfc000001011900010801011d08011001011b10011401011d`) as music.sequencer.Song
        let song_C1 = music.createSong(hex`006A000408050100001c00010a006400f4016400000400000000000000000000000000050000049c0014001800011618001c0001191c002000011b20002800011d28002e00011d2e003000011b30003400011d34003800011b38004000011d40004400011d44004800012048004c00011d4c005000011b50005800011d5c006000011960006800011b68006e00011b6e007000011970007400011b74007800011978008000011b80008400011d84008800011d88008c00011d8c009000011e90009400011d`) as music.sequencer.Song
        let song_C2 = music.createSong(hex`006a000408060100001c00010a006400f401640000040000000000000000000000000005000004ae0014001800011618001c0001191c002000011b20002800011d28002e00011d2e003000011b30003400011d34003800011b38004000011d40004400011d44004800012048004c00011d4c005000011b50005800011d5c006000011960006400011b64006c00011b6c007000011970007400011b74007800011978007c00011b7c008000011e80008400011d84008800011d8c009000011690009400011d94009800011b98009c0001199c00b0000116`) as music.sequencer.Song
        let lyric_A = "\
        我又哼着 在梦里那首歌\
        很久没见过- 故乡的月色\
        奶奶的蒲扇 摇着那槐花落\
        爷爷的烟袋- 飘向了银-河"
        let lyric_B = "\
        恍恍忽忽的我们忽然睡着了\
        梦里你说要去四海漂泊-\
        醒来的午后-又是秋雨落-\
        你真就这么就这么抛下了我" //恍恍惚惚, "惚" absence in font
        let lyric_C1 = "\
        我们在故事里绕啊绕人儿不见了\
        风雨打湿我衣角没你怎么好"
        let lyric_C2 = "\
        我看着 炊烟起飘啊飘 回忆摇啊摇\
        我多想要睡醒了一-觉 你和我还小"
        let song = SongEditor.append(song_A, song_B, true)
        song = SongEditor.append(song, song_C1, true)
        song = SongEditor.append(song, song_C2, true)
        // song = SongEditor.replaceInstrument(song, 3, 0)
        let songDrum = SongEditor.repeat(songDrum_1, song_A.measures - 2)
        songDrum = SongEditor.append(songDrum, songDrum_11)
        songDrum = SongEditor.append(songDrum, SongEditor.repeat(songDrum_2, song.measures - songDrum.measures))

        song = SongEditor.merge(song, songDrum)
        const lyric = lyric_A + lyric_B + lyric_C1 + lyric_C2
        Karaoke.playSong(song, "多想还小", lyric)

    }
    // 宝贝宝贝
    else if (selectedSongID == 4) {
        let song_A1 = music.createSong(hex`0078000408080100001c00010a006400f401640000040000000000000000000000000005000004ba0000000800011908001000011b10001800011d18002000011920002800011d28003000012030003800012040004800011d48004c0001224c005000012250005800012258006000012260006800012068007000012070007800011d8000880001198c009000011990009800011998009c0001229c00a0000122a000a8000120a800b000011db000b8000120c000c400011bc400c800011bcc00d000011bd000d400011dd400d800011bd800dc000119dc00e000011de000f800011b`) as music.sequencer.Song
        let song_A2 = music.createSong(hex`0078000408080100001c00010a006400f401640000040000000000000000000000000005000004b40000000800011908001000011b10001800011d18002000011920002800011d28002c0001202c003000012030003800012040004800011d4800500001225000580001225800600001256000680001246800700001227000780001208000880001198c00900001199000980001199800a0000122a000a8000120a800b0000120b000b800011dc000c400011bc400cc00011bcc00d000011bd000d400011dd400d800011bd800dc000119dc00e000011be000f8000119`) as music.sequencer.Song
        let song_B1 = music.createSong(hex`0078000408090200001c00010a006400f401640000040000000000000000000000000005000004d2001c00200001202000280001252c003000012530003400012534003800012038003c00011d3c00400001254000500001245000540001255c006000011d6000680001226c007000012270007400012274007800012078007c0001227c0080000124800090000120900094000120a000a800011da800ac000120ac00b0000120b000b8000120b800c0000122c000cc000127cc00d0000127d000e0000122e000e4000120e400e8000120e800ec000120ec00f0000122f000f4000124f400f8000122f800fc000124fc000001012500011001012709010e02026400000403780000040a000301000000640001c80000040100000000640001640000040100000000fa0004af00000401c80000040a00019600000414000501006400140005010000002c0104dc00000401fa0000040a0001c8000004140005d0076400140005d0070000c800029001f40105c201f4010a0005900114001400039001000005c201f4010500058403050032000584030000fa00049001000005c201f4010500058403c80032000584030500640005840300009001049001000005c201f4010500058403c80064000584030500c8000584030000f40105ac0d000404a00f00000a0004ac0d2003010004a00f0000280004ac0d9001010004a00f0000280002d00700040408070f0064000408070000c80003c800c8000e7d00c80019000e64000f0032000e78000000fa00032c01c8000ee100c80019000ec8000f0032000edc000000fa0003f401c8000ea901c80019000e90010f0032000ea4010000fa0001c8000004014b000000c800012c01000401c8000000c8000190010004012c010000c80002c800000404c8000f0064000496000000c80002c2010004045e010f006400042c010000640002c409000404c4096400960004f6090000f40102b80b000404b80b64002c0104f40b0000f401022003000004200300040a000420030000ea01029001000004900100040a000490010000900102d007000410d0076400960010d0070000c8000c00500051000108900091000108`) as music.sequencer.Song
        let song_B2 = music.createSong(hex`0078000408090200001c00010a006400f401640000040000000000000000000000000005000004ea001c00200001202000280001252c003000012530003400012534003800012038003c00011d3c00400001254000500001245000540001275400580001225c006000011d6000680001226c007000012270007400012274007800012078007a0001227a0080000124800090000120900094000120940098000120a000a800011da800b0000120b000b8000120b800bc000125bc00c0000125c000c4000125c400c8000125c800cc000125cc00d0000127d000e0000122e000e4000120e400e8000120e800ec000122ec00f0000122f000f4000124f400f8000122f800fc000124fc000001012700012001012509010e02026400000403780000040a000301000000640001c80000040100000000640001640000040100000000fa0004af00000401c80000040a00019600000414000501006400140005010000002c0104dc00000401fa0000040a0001c8000004140005d0076400140005d0070000c800029001f40105c201f4010a0005900114001400039001000005c201f4010500058403050032000584030000fa00049001000005c201f4010500058403c80032000584030500640005840300009001049001000005c201f4010500058403c80064000584030500c8000584030000f40105ac0d000404a00f00000a0004ac0d2003010004a00f0000280004ac0d9001010004a00f0000280002d00700040408070f0064000408070000c80003c800c8000e7d00c80019000e64000f0032000e78000000fa00032c01c8000ee100c80019000ec8000f0032000edc000000fa0003f401c8000ea901c80019000e90010f0032000ea4010000fa0001c8000004014b000000c800012c01000401c8000000c8000190010004012c010000c80002c800000404c8000f0064000496000000c80002c2010004045e010f006400042c010000640002c409000404c4096400960004f6090000f40102b80b000404b80b64002c0104f40b0000f401022003000004200300040a000420030000ea01029001000004900100040a000490010000900102d007000410d0076400960010d0070000c8001800500051000108540055000108900091000108940095000108`) as music.sequencer.Song
        // let song_drum = music.createSong(hex`005a000408010109010e02026400000403780000040a000301000000640001c80000040100000000640001640000040100000000fa0004af00000401c80000040a00019600000414000501006400140005010000002c0104dc00000401fa0000040a0001c8000004140005d0076400140005d0070000c800029001f40105c201f4010a0005900114001400039001000005c201f4010500058403050032000584030000fa00049001000005c201f4010500058403c80032000584030500640005840300009001049001000005c201f4010500058403c80064000584030500c8000584030000f40105ac0d000404a00f00000a0004ac0d2003010004a00f0000280004ac0d9001010004a00f0000280002d00700040408070f0064000408070000c80003c800c8000e7d00c80019000e64000f0032000e78000000fa00032c01c8000ee100c80019000ec8000f0032000edc000000fa0003f401c8000ea901c80019000e90010f0032000ea4010000fa0001c8000004014b000000c800012c01000401c8000000c8000190010004012c010000c80002c800000404c8000f0064000496000000c80002c2010004045e010f006400042c010000640002c409000404c4096400960004f6090000f40102b80b000404b80b64002c0104f40b0000f401022003000004200300040a000420030000ea01029001000004900100040a000490010000900102d007000410d0076400960010d0070000c8003400000001000200050400050001050800090001050c000d00020005100011000105140015000200051800190002050a1c001d000105`) as music.sequencer.Song
        let song_drum = music.createSong(hex`005a000408010109010e02026400000403780000040a000301000000640001c80000040100000000640001640000040100000000fa0004af00000401c80000040a00019600000414000501006400140005010000002c0104dc00000401fa0000040a0001c8000004140005d0076400140005d0070000c800029001f40105c201f4010a0005900114001400039001000005c201f4010500058403050032000584030000fa00049001000005c201f4010500058403c80032000584030500640005840300009001049001000005c201f4010500058403c80064000584030500c8000584030000f40105ac0d000404a00f00000a0004ac0d2003010004a00f0000280004ac0d9001010004a00f0000280002d00700040408070f0064000408070000c80003c800c8000e7d00c80019000e64000f0032000e78000000fa00032c01c8000ee100c80019000ec8000f0032000edc000000fa0003f401c8000ea901c80019000e90010f0032000ea4010000fa0001c8000004014b000000c800012c01000401c8000000c8000190010004012c010000c80002c800000404c8000f0064000496000000c80002c2010004045e010f006400042c010000640002c409000404c4096400960004f6090000f40102b80b000404b80b64002c0104f40b0000f401022003000004200300040a000420030000ea01029001000004900100040a000490010000900102d007000410d0076400960010d0070000c8001800000001000107080009000107100011000107180019000107`) as music.sequencer.Song
        // let song_drum2 = music.createSong(hex`005a000408010109010e02026400000403780000040a000301000000640001c80000040100000000640001640000040100000000fa0004af00000401c80000040a00019600000414000501006400140005010000002c0104dc00000401fa0000040a0001c8000004140005d0076400140005d0070000c800029001f40105c201f4010a0005900114001400039001000005c201f4010500058403050032000584030000fa00049001000005c201f4010500058403c80032000584030500640005840300009001049001000005c201f4010500058403c80064000584030500c8000584030000f40105ac0d000404a00f00000a0004ac0d2003010004a00f0000280004ac0d9001010004a00f0000280002d00700040408070f0064000408070000c80003c800c8000e7d00c80019000e64000f0032000e78000000fa00032c01c8000ee100c80019000ec8000f0032000edc000000fa0003f401c8000ea901c80019000e90010f0032000ea4010000fa0001c8000004014b000000c800012c01000401c8000000c8000190010004012c010000c80002c800000404c8000f0064000496000000c80002c2010004045e010f006400042c010000640002c409000404c4096400960004f6090000f40102b80b000404b80b64002c0104f40b0000f401022003000004200300040a000420030000ea01029001000004900100040a000490010000900102d007000410d0076400960010d0070000c800340000000100020005040005000105080009000205090c000d00010510001100020205140015000105180019000205091c001d000105`) as music.sequencer.Song
        let song = SongEditor.append(song_A1, song_A2)
        song = SongEditor.append(song, song_B1, true)
        song = SongEditor.append(song, song_B2, true)
        song = SongEditor.riseFallTone(song, -12)
        // song = SongEditor.addTracks(song, SongEditor.riseFallTone(song, -5))
        song_drum = SongEditor.repeat(song_drum, song.measures)
        song = SongEditor.merge(song, song_drum)
        let lyric_A = "\
        两只老虎爱跳舞\
        小兔子乖 乖拔萝卜\
        我和小鸭子学走路\
        童年是最美的礼物\
        \
        小螺号呀嘀 嘀地 吹\
        我学海鸥展翅飞\
        不 怕风雨不怕累\
        快快把本领都学会"
        let lyric_B = "\
        宝贝 星星为你指路 哦\
        宝贝 月亮为你祝福 哦\
        成长是快乐的旅途\
        勇敢迈开你的脚-步\
        宝贝 妈妈怀里安睡 妈妈\
        宝贝 爸爸是你椅背 爸爸\
        你是我们的心肝宝-贝\
        爸爸妈妈的爱永相随"

        let lyric = lyric_A + lyric_B
        Karaoke.playSong(song, "宝贝宝贝", lyric)

    }
}


// Karaoke common control
{
    game.onPaint(() => {
        Karaoke.drawChart()
    })

    function upDown(delta:number){
        if(Karaoke.isPlaying())
            Karaoke.changeBPM(delta)
        else
            Karaoke.changePitch(delta)
    }

    function leftRight(delta:number){
        if(Karaoke.isPlaying())
            Karaoke.shiftSentence(delta)
        else
        {
            Karaoke.changeNoteWidth(delta)
            // Karaoke.setYOffset(Karaoke.getYOffset()+ delta)
            // Karaoke.showAsScore(Karaoke.getYOffset())
        }
    }

    controller.B.onEvent(ControllerButtonEvent.Pressed, function () {
        Karaoke.restart()
    })
    controller.A.onEvent(ControllerButtonEvent.Pressed, function () {
        if (Karaoke.isPlaying()) {
            Karaoke.stop()
        } else {
            Karaoke.resume()
        }
    })
    controller.up.onEvent(ControllerButtonEvent.Pressed, function () {
        upDown(1)
    })
    controller.up.onEvent(ControllerButtonEvent.Repeated, function () {
        upDown(1)
    })
    controller.down.onEvent(ControllerButtonEvent.Repeated, function () {
        upDown(-1)
    })
    controller.down.onEvent(ControllerButtonEvent.Pressed, function () {
        upDown(-1)
    })
    controller.right.onEvent(ControllerButtonEvent.Pressed, function () {
        leftRight(1)
    })
    controller.right.onEvent(ControllerButtonEvent.Repeated, function () {
        leftRight(1) //ticks, 1 measure = 32 ticks
    })
    controller.left.onEvent(ControllerButtonEvent.Pressed, function () {
        leftRight(-1)
    })
    controller.left.onEvent(ControllerButtonEvent.Repeated, function () {
        leftRight(-1)
    })
}
// end Karaoke common control